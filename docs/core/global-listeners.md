GlobalListeners в архитектуре приложения — это координатор событий, который превращает линейный поток UI в систему реакций на внешние триггеры. Он существует не как место для UI-логики, а как инфраструктурный слой, который слушает события из разных частей приложения и принимает решение, как на них отреагировать: показать уведомление, открыть экран, показать диалог или выполнить навигацию.

Приложение живёт не только в потоке пользовательских действий. Могут прийти диплинки извне, сервер может прислать пуш-уведомление, токен может протухнуть в середине сессии. Эти события не привязаны к конкретному экрану и не имеют контекста текущего UI. GlobalListeners становится точкой входа для таких событий — он слушает изменения в нотифаерах и координирует глобальные действия, не затрагивая бизнес-логику модулей.

Каждое событие инкапсулировано в свой нотифаер. Логаут не знает о диплинках, диплинки не знают о снэкбарах, снэкбары не знают о навигации. Модули остаются изолированными, а связь между ними происходит через события. Когда AuthInterceptor ловит ошибку четыреста первой, он не решает, что показать пользователю — он просто триггерит LogoutNotifier. GlobalListeners слушает это событие и принимает решение: показать снэкбар с текстом об истёкшей сессии. Если завтра понадобится вместо снэкбара открывать экран логина — изменения будут локализованы в одном месте.

Этот подход разделяет намерение и действие. Модуль говорит «произошло событие», а координатор решает, что с этим делать. Диплинк-провайдер триггерит событие с урлом, а GlobalListeners парсит его и открывает нужный экран. Новостной сервис сигнализирует о новости, а координатор решает показать диалог или bottom sheet. Такая архитектура позволяет добавлять новые глобальные события без изменения существующих модулей — достаточно добавить ещё один слушатель.

GlobalListeners не содержит бизнес-логики. Он не принимает доменных решений и не строит сложные UI-компоненты. Его задача — слушать и координировать. Если нужно построить снэкбар, он делегирует это SnackBarBuilder. Если нужно выполнить навигацию, он вызывает роутер. Если нужно показать диалог, он использует showDialog с готовым виджетом. Координатор остаётся тонким слоем, который знает только о том, как связать событие с действием.

Такая система не создаёт спагетти, если соблюдать правило: координатор реагирует на инфраструктурные события напрямую, без промежуточных нотифаеров. UI-нотифаеры существуют для удобного вызова из виджетов и view model, но не для перенаправления событий внутри координатора. Когда инфраструктурное событие требует показа UI, координатор сам создаёт и показывает его, минуя лишние звенья.

В результате приложение получает гибкую систему нелинейной навигации и глобальных действий. Внешний мир может влиять на приложение через события, модули остаются изолированными, а вся координация сосредоточена в одном месте. GlobalListeners оборачивает корневой виджет и живёт на протяжении всей жизни приложения, обеспечивая единую точку реакции на события, которые не привязаны к конкретному экрану.
